<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
</head>

<body>
<h1>短碼編程</h1>
<p>分享一段求質數的特短代碼</p>
<pre><code>a;
f(x){
    int i,r;
    a=sqrt(x);
    r=x>1;
    for(i=2;r&&i<=a;r=x%i++);
    a=r;
}</code></pre>
<p>簡單說明一下，求解絲路為，計算從2至sqrt(x)範圍內，查看是否有值能夠被x整除，若有則不是質數，否則是質數。</p>
<p>r保存是否是質數，一開始判斷x的值是否小於2，如果是，則肯定不是質數，設置r為0。在之後的for語句中，判斷r是否為0，是則跳出。然後將r的值傳遞給a。a是一個全局變數，只是用來保存一下sqrt(x)的值和被r賦值。因為在用變數賦值給變數的過程中，會借助到EAX寄存器，而C語言變數的返回值一般也是保存在EAX寄存器中，故可省略一個return。最後，for的每次迭代中，會判斷x與i求余的結果是否為0，是，則x不是質數，然後設置r為0。</p>

<p style="display:none">
main(){
    
    time_t t = time(NULL);
    int i,j;
    for(i=2;i< N;i++){
        if(m[i] != -1){
            //printf("%d ",i);
            for(j=2*i;j< N;j+=i){
                m[j] = -1;
            }
        }
    }
    printf("\n%d\n",time(NULL)-t);
    t=time(NULL);

    for(i=B;i< N;i++){
        assert((f(i)>0?0:-1) == m[i]);
        if(f(i)>0){
            printf("%d ",i);
        }
    }
    printf("\n%d\n",time(NULL)-t);

    scanf("%d",&i);
    printf("%d\n",f(i)>0);


}
</p>
<p>pow函式</p>
<pre><code>
p(x,y){
    int s;
    for(s=1;y;y/=2,x*=x)
        s*=y%2?x:1;
    x=s;
}

main(){
    int i,j;
    for(i=0;i<8;i++){
        for(j=0;j<8;j++){
            printf("%d^%d\t%d\t%g\n",i,j,p(i,j),pow(i,j));
            assert(p(i,j)==pow(i,j));
        }
    }
}
</code></pre>
</body>
</html>
